@startuml
title Client UnBlock - PUT /clients/:client_id/unblock

actor Requester
boundary ClientPutUnblockHandler <<clientHandler.go>>
control AuthorizeService <<serviceAuthorize.go>>
control ClientService <<serviceService.go>>
entity ClientFirestore <<model/client/firestore.go>>

Requester -> ClientPutUnblockHandler : PUT /clients/:client_id/unblock
activate Requester
activate ClientPutUnblockHandler
ClientPutUnblockHandler -> AuthorizeService : Authorize(Cookie)
activate AuthorizeService
AuthorizeService --> ClientPutUnblockHandler : Claims / Error
deactivate AuthorizeService
alt Authorization Failed
    ClientPutUnblockHandler --> Requester : HTTP Error Response
else Authorization Succeeded
    ClientPutUnblockHandler -> ClientService : ClientUnblock(clientID)
    activate ClientService
    ClientService -> ClientService : Client(clientID)
    ClientService -> ClientFirestore : Get(&clientID)
    activate ClientFirestore
    ClientFirestore --> ClientService : ClientData / Error
    deactivate ClientFirestore
    alt Get Client Failed
        ClientService --> ClientService : Error
        ClientService --> ClientPutUnblockHandler : Error
        ClientPutUnblockHandler --> Requester : HTTP Error Response
    else Get Client Succeeded
        ClientService --> ClientService : Client
        ClientService -> ClientFirestore : Update(Client with Status=true)
        activate ClientFirestore
        ClientFirestore --> ClientService : nil / Error
        deactivate ClientFirestore
        alt Update Client Failed
            ClientService --> ClientPutUnblockHandler : Error
            ClientPutUnblockHandler --> Requester : HTTP Error Response
        else Update Client Succeeded
            ClientService --> ClientPutUnblockHandler : nil
            ClientPutUnblockHandler --> Requester : HTTP 200 OK (Client Blocked)
        end
        deactivate ClientService
    end
    deactivate ClientPutUnblockHandler
end
deactivate Requester

@enduml