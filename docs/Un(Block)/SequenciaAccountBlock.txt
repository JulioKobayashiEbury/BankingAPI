@startuml
title Account Block - PUT /accounts/:account_id/block

actor Requester
boundary AccountPutBlockHandler <<accountHandler.go>>
control AuthorizeService <<serviceAuthorize.go>>
control AccountService <<serviceAccount.go>>
entity AccountFirestore <<model/account/firestore.go>>

activate Requester
Requester -> AccountPutBlockHandler : PUT /accounts/:account_id/block
activate AccountPutBlockHandler
AccountPutBlockHandler -> AuthorizeService : Authorize(Cookie)
activate AuthorizeService
AuthorizeService --> AccountPutBlockHandler : Claims / Error
deactivate AuthorizeService
alt Authorization Failed
    AccountPutBlockHandler --> Requester : HTTP Error Response
else Authorization Succeeded
    AccountPutBlockHandler -> AccountService : AccountBlock(accountID)
    activate AccountService
    AccountService -> AccountService : Account(accountID)
    AccountService -> AccountFirestore : Get(&accountID)
    activate AccountFirestore
    AccountFirestore --> AccountService : accountData / Error
    deactivate AccountFirestore
    alt Get Account Failed
        AccountService --> AccountService : Error
        AccountService --> AccountPutBlockHandler : Error
        AccountPutBlockHandler --> Requester : HTTP Error Response
    else Get Account Succeeded
        AccountService --> AccountService : account
        AccountService -> AccountFirestore : Update(account with Status=false)
        activate AccountFirestore
        AccountFirestore --> AccountService : nil / Error
        deactivate AccountFirestore
        alt Update Account Failed
            AccountService --> AccountPutBlockHandler : Error
            AccountPutBlockHandler --> Requester : HTTP Error Response
        else Update Account Succeeded
            AccountService --> AccountPutBlockHandler : nil
            AccountPutBlockHandler --> Requester : HTTP 200 OK (Account Blocked)
        end
    end
    deactivate AccountService
end
deactivate AccountPutBlockHandler
deactivate Requester

@enduml