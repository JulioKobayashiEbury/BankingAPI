@startuml
title Create Client - POST /clients

actor Requester
boundary ClientPostHandler <<clientHandler.go>>
control ClientService <<serviceClient.go>>
entity UserFirestore <<model/user/firestore.go>>
entity ClientFirestore <<model/client/firestore.go>>

activate Requester

Requester -> ClientPostHandler : POST /clients (Body: ClientRequest Info)
activate ClientPostHandler

ClientPostHandler -> ClientService : CreateClient(clientRequest)
activate ClientService

alt Missing Credentials (User_id, Document, or Name)
    ClientService -->> ClientPostHandler : Error (Missing credentials for creating client)
    ClientPostHandler -->> Requester : HTTP Error Response
else
    ClientService -> UserFirestore : Get(&clientRequest.User_id)
    activate UserFirestore
    UserFirestore -->> ClientService : userData / Error (IDnotFound or other)
    deactivate UserFirestore
    
    alt User Not Found or Error
        ClientService -->> ClientPostHandler : Error
        ClientPostHandler -->> Requester : HTTP Error Response
    else User Exists
        ClientService -> ClientFirestore : Create(clientRequest)
        activate ClientFirestore
        ClientFirestore -->> ClientService : clientID_ptr / Error
        deactivate ClientFirestore
        alt Create Client Record Failed
            ClientService -->> ClientPostHandler : Error
            ClientPostHandler -->> Requester : HTTP Error Response
        else Create Client Record Succeeded
            ClientService -> ClientService : Client(*clientID_ptr)
            ClientService -> ClientFirestore : Get(*clientID_ptr)
            activate ClientFirestore
            ClientFirestore -->> ClientService : createdClientData / Error
            deactivate ClientFirestore
            
            alt Get Created Client Failed
                ClientService -->> ClientService : Error
                ClientService -->> ClientPostHandler : Error
                ClientPostHandler -->> Requester : HTTP Error Response
            else Get Created Client Succeeded
                ClientService -->> ClientService : createdClientResponse
                ClientService -->> ClientPostHandler : createdClientResponse
                ClientPostHandler -->> Requester : HTTP 200 OK (createdClientResponse)
            end

        end
    end
end
deactivate ClientService
deactivate ClientPostHandler
deactivate Requester
@enduml